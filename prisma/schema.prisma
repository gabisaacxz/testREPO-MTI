// ======================================
// Generator & Datasource
// ======================================
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ======================================
// User Model
// ======================================
model User {
  id             String          @id @default(uuid()) @db.Uuid
  email          String          @unique
  passwordHash   String
  firstName      String
  lastName       String
  role           String          @default("USER")
  status         String          @default("ACTIVE")
  workStartTime  String?         // Added from your diagram
  workEndTime    String?         // Added from your diagram
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  
  // Relations
  attendanceLogs AttendanceLog[]

  @@map("users")
}

// ======================================
// Site Model
// ======================================
model Site {
  id              String          @id @default(uuid()) @db.Uuid
  siteIdCode      String?         @unique // e.g., "MNL-001"
  siteName        String
  locationAddress String?
  isActive        Boolean         @default(true)
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  // Relations
  attendanceLogs  AttendanceLog[]

  @@map("sites")
}

// ======================================
// Attendance Logs
// ======================================
model AttendanceLog {
  id             String    @id @default(uuid()) @db.Uuid
  userId         String    @db.Uuid
  siteId         String    @db.Uuid
  attendanceDate DateTime  @db.Date
  timeIn         DateTime?
  timeOut        DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt

  // Relationship Definitions
  user           User      @relation(fields: [userId], references: [id])
  site           Site      @relation(fields: [siteId], references: [id])

  @@unique([userId, attendanceDate])
  @@index([attendanceDate])
  @@index([siteId])
  @@map("attendance_logs")
}